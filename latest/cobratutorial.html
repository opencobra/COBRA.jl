<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · COBRA.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script></head><body><nav class="toc"><a href="index.html"><img class="logo" src="assets/logo.png" alt="COBRA.jl logo"/></a><h1>COBRA.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">COBRA.jl - COnstraint-Based Reconstruction and Analysis</a></li><li><a class="toctext" href="cbg.html">Beginner&#39;s Guide</a></li><li class="current"><a class="toctext" href="cobratutorial.html">Tutorial</a><ul class="internal"><li><a class="toctext" href="#Beginner&#39;s-Guide-1">Beginner&#39;s Guide</a></li><li><a class="toctext" href="#Quick-installation-1">Quick installation</a></li><li><a class="toctext" href="#Quick-help-1">Quick help</a></li><li><a class="toctext" href="#Installation-check-and-package-testing-1">Installation check and package testing</a></li><li><a class="toctext" href="#Adding-local-workers-1">Adding local workers</a></li><li><a class="toctext" href="#Define-and-change-the-COBRA-solver-1">Define and change the COBRA solver</a></li><li><a class="toctext" href="#Load-a-COBRA-model-1">Load a COBRA model</a></li><li><a class="toctext" href="#Flux-Balance-Analysis-(FBA)-1">Flux Balance Analysis (FBA)</a></li><li><a class="toctext" href="#Flux-Variability-Analysis-(FVA)-1">Flux Variability Analysis (FVA)</a></li><li><a class="toctext" href="#Distributed-FBA-of-distinct-reactions-1">Distributed FBA of distinct reactions</a></li><li><a class="toctext" href="#Save-the-variables-1">Save the variables</a></li><li><a class="toctext" href="#References-1">References</a></li></ul></li><li><a class="toctext" href="configuration.html">Configuration</a></li><li><a class="toctext" href="functions.html">Modules and Functions</a></li><li><a class="toctext" href="faq.html">FAQ</a></li><li><a class="toctext" href="contents.html">Index</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="cobratutorial.html">Tutorial</a></li></ul><a class="edit-page" href="https://github.com/opencobra/COBRA.jl/tree/ac2148d2c34112f9477893353cdc43052708df9a/docs/src/cobratutorial.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="COBRA.jl-Tutorial-1" href="#COBRA.jl-Tutorial-1">COBRA.jl - Tutorial</a></h1><p>This tutorial serves as a quick start guide as well as an interactive reference for more advanced users.</p><p>Download the live notebook <a href="https://github.com/opencobra/COBRA.jl/tree/master/docs/tutorial">here</a>.</p><h2><a class="nav-anchor" id="Beginner&#39;s-Guide-1" href="#Beginner&#39;s-Guide-1">Beginner&#39;s Guide</a></h2><p>Should you not have any prior experience with Julia and/or Linux, please <strong>read carefully</strong> the <a href="http://opencobra.github.io/COBRA.jl/stable/cobratutorial.html">Beginner&#39;s Guide</a>. If you however feel that you are set to proceed with this tutorial, please consider the Beginner&#39;s Guide as a go-to reference in case you are running into any issues. If you see unusual behavior, you may consider reading the <a href="http://opencobra.github.io/COBRA.jl/stable/faq.html">FAQ section</a>.</p><h2><a class="nav-anchor" id="Quick-installation-1" href="#Quick-installation-1">Quick installation</a></h2><p>Should you not already have the <code>COBRA.jl</code> package, you must first first follow the installation instructions <a href="http://opencobra.github.io/COBRA.jl/">here</a>.</p><blockquote><p>Please note that should you run this tutorial on an already configured system, the following lines will throw an error message.</p></blockquote><p>Before running any function of <code>COBRA.jl</code>, it is necessary to include the <code>COBRA.jl</code> module:</p><pre><code class="language-julia">using COBRA</code></pre><h2><a class="nav-anchor" id="Quick-help-1" href="#Quick-help-1">Quick help</a></h2><p>Should you feel lost or don&#39;t know the meaning of certain input parameters, try typing a question mark at the Julia REPL followed by a keyword. For instance:</p><pre><code class="language-julia">? distributedFBA</code></pre><h2><a class="nav-anchor" id="Installation-check-and-package-testing-1" href="#Installation-check-and-package-testing-1">Installation check and package testing</a></h2><p>Please make sure that you have a working installation of <code>MathProgBase.jl</code> and at least one of the supported solvers. You may find further information <a href="http://mathprogbasejl.readthedocs.io/en/latest/">here</a>. You may run the following in order to be sure and check your system&#39;s configuration.</p><p>You can find further information on how to install other supported solvers, such as <code>CPLEX</code>, <code>CLP</code>, <code>Gurobi</code>, or <code>Mosek</code> <a href="https://github.com/JuliaOpt">here</a>.</p><pre><code class="language-julia"># loads the functions to check your setup
include(&quot;$(Pkg.dir(&quot;COBRA&quot;))/src/checkSetup.jl&quot;)

# list your installed packages
packages = checkSysConfig()

# clear the workspace of loaded packages
workspace()</code></pre><p>You may, at any time, check the integrity of the <code>COBRA.jl</code> package by running:</p><pre><code class="language-Julia">Pkg.test(&quot;COBRA&quot;)</code></pre><p>The code has been benchmarked against the <code>fastFVA</code> implementation [<a href="#References-1">3</a>]. A test model <code>ecoli_core_model.mat</code> [<a href="#References-1">4</a>] can be used to pre-compile the code and is available in the <code>/test</code> folder. The modules and solvers are correctly installed when all tests pass without errors (warnings may appear).</p><h2><a class="nav-anchor" id="Adding-local-workers-1" href="#Adding-local-workers-1">Adding local workers</a></h2><p>The connection functions are given in <code>connect.jl</code>, which, if a parallel version is desired, must be included separately:</p><pre><code class="language-julia">include(&quot;$(Pkg.dir(&quot;COBRA&quot;))/src/connect.jl&quot;)</code></pre><p>You may add local workers as follows:</p><pre><code class="language-julia"># specify the total number of parallel workers
nWorkers = 4

# create a parallel pool
workersPool, nWorkers = createPool(nWorkers)</code></pre><p>The IDs of the respective workers are given in <code>workersPool</code>, and the number of local workers is stored in <code>nWorkers</code>.</p><p>In order to be able to use the <code>COBRA</code> module on all connected workers, you must invoke (the <code>Compat</code> package may throw errors):</p><pre><code class="language-julia">using COBRA</code></pre><h2><a class="nav-anchor" id="Define-and-change-the-COBRA-solver-1" href="#Define-and-change-the-COBRA-solver-1">Define and change the COBRA solver</a></h2><p>Before the COBRA solver can be defined, the solver parameters and configuration must be loaded after having set the <code>solverName</code> (solver must be installed):</p><ul><li><p><code>:GLPKMathProgInterface</code></p></li><li><p><code>:CPLEX</code></p></li><li><p><code>:Clp</code></p></li><li><p><code>:Gurobi</code></p></li><li><p><code>:Mosek</code></p></li></ul><pre><code class="language-julia"># specify the solver name
solverName = :GLPKMathProgInterface

# include the solver configuration file
include(&quot;$(Pkg.dir(&quot;COBRA&quot;))/config/solverCfg.jl&quot;)

# change the COBRA solver
solver = changeCobraSolver(solverName, solParams)</code></pre><p>where <code>solParams</code> is an array with the definition of the solver parameters.</p><h2><a class="nav-anchor" id="Load-a-COBRA-model-1" href="#Load-a-COBRA-model-1">Load a COBRA model</a></h2><p>As a test and as an example, the <em>E.coli</em> core model may be loaded as:</p><pre><code class="language-julia"># load the stoichiometric matrix S from a struct named model in the specified .mat file
model = loadModel(&quot;$(Pkg.dir(&quot;COBRA&quot;))/test/ecoli_core_model.mat&quot;, &quot;S&quot;, &quot;model&quot;);</code></pre><p>where <code>S</code> is the name of the field of the stoichiometric matrix and <code>model</code> is the name of the model. Note the semicolon that suppresses the ouput of <code>model</code>.</p><h2><a class="nav-anchor" id="Flux-Balance-Analysis-(FBA)-1" href="#Flux-Balance-Analysis-(FBA)-1">Flux Balance Analysis (FBA)</a></h2><p>In order to run a flux balance analysis (FBA), <code>distributedFBA</code> can be invoked with only 1 reaction and without an extra condition:</p><pre><code class="language-julia"># set the reaction list (only one reaction)
rxnsList = 13

# select the reaction optimization mode
#  0: only minimization
#  1: only maximization
#  2: maximization and minimization
rxnsOptMode = 1

# launch the distributedFBA process with only 1 reaction on 1 worker
# distributedFBA(model, solver, nWorkers, optPercentage, objective, rxnsList, strategy, preFBA, rxnsOptMode)
minFlux, maxFlux  = distributedFBA(model, solver, 1, 90.0, &quot;&quot;, rxnsList, 0, rxnsOptMode, false);</code></pre><p>where the reaction number <code>13</code> is solved. Note that the no extra conditions are added to the model (last function argument is <code>false</code>). The minimum flux and maximum flux can hence be listed as:</p><pre><code class="language-julia">maxFlux[rxnsList]</code></pre><h2><a class="nav-anchor" id="Flux-Variability-Analysis-(FVA)-1" href="#Flux-Variability-Analysis-(FVA)-1">Flux Variability Analysis (FVA)</a></h2><p>In order to run a common flux variability analysis (FVA), <code>distributedFBA</code> can be invoked with all reactions as follows:</p><pre><code class="language-julia">nWorkers = 4

# launch the distributedFBA process with all reactions
# distributedFBA(model, solver, nWorkers, optPercentage, objective, rxnsList, strategy, preFBA, rxnsOptMode)
minFlux, maxFlux, optSol, fbaSol, fvamin, fvamax = distributedFBA(model, solver, nWorkers, 90.0, &quot;max&quot;);</code></pre><p>The optimal solution of the original FBA problem can be retrieved with:</p><pre><code class="language-julia">optSol</code></pre><p>The corresponding solution vector <code>maxFlux</code> of the original FBA that is solved with:</p><pre><code class="language-julia">fbaSol</code></pre><p>The minimum and maximum fluxes of each reaction are in:</p><pre><code class="language-julia">maxFlux</code></pre><p>The flux vectors of all the reactions are stored in <code>fvamin</code> and <code>fvamax</code>.</p><pre><code class="language-julia">fvamin</code></pre><pre><code class="language-julia">fvamax</code></pre><h2><a class="nav-anchor" id="Distributed-FBA-of-distinct-reactions-1" href="#Distributed-FBA-of-distinct-reactions-1">Distributed FBA of distinct reactions</a></h2><p>You may now input several reactions with various <code>rxnsOptMode</code> values to run specific optimization problems.</p><pre><code class="language-julia">rxnsList = [1; 18; 10; 20:30; 90; 93; 95]
rxnsOptMode = [0; 1; 2; 2+zeros(Int, length(20:30)); 2; 1; 0]

# run only a few reactions with rxnsOptMode and rxnsList
# distributedFBA(model, solver, nWorkers, optPercentage, objective, rxnsList, strategy, preFBA, rxnsOptMode)
minFlux, maxFlux, optSol, fbaSol, fvamin, fvamax, statussolmin, statussolmax = distributedFBA(model, solver, nWorkers, 90.0, &quot;max&quot;, rxnsList, 0, rxnsOptMode);</code></pre><p>Note that the reactions can be input as an unordered list.</p><h2><a class="nav-anchor" id="Save-the-variables-1" href="#Save-the-variables-1">Save the variables</a></h2><p>You can save the output of <code>distributedFBA</code> by using:</p><pre><code class="language-julia">saveDistributedFBA(&quot;results.mat&quot;)</code></pre><h2><a class="nav-anchor" id="References-1" href="#References-1">References</a></h2><ol><li><p><a href="http://www.cambridge.org/us/academic/subjects/life-sciences/genomics-bioinformatics-and-systems-biology/systems-biology-constraint-based-reconstruction-and-analysis?format=HB">B. O. Palsson. Systems Biology: Constraint-based Reconstruction and Analysis. Cambridge University Press, NY, 2015.</a></p></li><li><p><a href="https://github.com/opencobra/cobratoolbox">Schellenberger, J. et al. COBRA Toolbox 2.0. 05 2011.</a></p></li><li><p><a href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-11-489">Steinn, G. et al. Computationally efficient flux variability analysis. BMC Bioinformatics, 11(1):1–3, 2010.</a></p></li><li><p><a href="http://gcrg.ucsd.edu/Downloads/EcoliCore">Orth, J. et al. Reconstruction and use of microbial metabolic networks: the core escherichia coli metabolic model as an educational guide. EcoSal Plus, 2010.</a></p></li></ol><footer><hr/><a class="previous" href="cbg.html"><span class="direction">Previous</span><span class="title">Beginner&#39;s Guide</span></a><a class="next" href="configuration.html"><span class="direction">Next</span><span class="title">Configuration</span></a></footer></article></body></html>
